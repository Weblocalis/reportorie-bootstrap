<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Configuration du Sitemap - BoostifySEO</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- FontAwesome CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
  <div class="container mt-5">
    <h1 class="fw-bold mb-4">Configuration du Sitemap</h1>

    <!-- Section pour Ajouter une Nouvelle URL -->
    <form id="addUrlForm" class="mb-5">
      <div class="row g-3">
        <div class="col-md-6">
          <label for="url" class="form-label">URL</label>
          <input type="text" class="form-control" id="url" placeholder="https://example.com/page" required>
        </div>
        <div class="col-md-3">
          <label for="priority" class="form-label">Priorité</label>
          <select class="form-select" id="priority" required>
            <option value="1.0">1.0 (Très élevé)</option>
            <option value="0.8">0.8 (Élevé)</option>
            <option value="0.5" selected>0.5 (Moyen)</option>
            <option value="0.3">0.3 (Faible)</option>
          </select>
        </div>
        <div class="col-md-3">
          <label for="changefreq" class="form-label">Fréquence</label>
          <select class="form-select" id="changefreq" required>
            <option value="always">Toujours</option>
            <option value="hourly">Toutes les heures</option>
            <option value="daily" selected>Quotidien</option>
            <option value="weekly">Hebdomadaire</option>
            <option value="monthly">Mensuel</option>
            <option value="yearly">Annuel</option>
            <option value="never">Jamais</option>
          </select>
        </div>
      </div>
      <button type="submit" class="btn btn-primary mt-3"><i class="fas fa-plus"></i> Ajouter</button>
    </form>

    <!-- Tableau des URLs dans le Sitemap -->
    <div class="table-responsive">
      <table class="table table-hover">
        <thead class="table-dark">
          <tr>
            <th>#</th>
            <th>URL</th>
            <th>Priorité</th>
            <th>Fréquence</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="sitemapTable">
          <!-- Les URLs ajoutées seront insérées ici dynamiquement -->
        </tbody>
      </table>
    </div>

    <!-- Boutons pour Exporter/Mettre à Jour le Sitemap -->
    <div class="mt-4 d-flex justify-content-between">
      <button class="btn btn-success" id="generateSitemap"><i class="fas fa-file-export"></i> Exporter le Sitemap</button>
      <button class="btn btn-danger" id="clearSitemap"><i class="fas fa-trash"></i> Effacer tout</button>
    </div>
  </div>

  <!-- Script jQuery -->
  <script>
    $(document).ready(function () {
      let sitemapData = [];

      // Ajouter une nouvelle URL au tableau
      $('#addUrlForm').on('submit', function (e) {
        e.preventDefault();

        const url = $('#url').val();
        const priority = $('#priority').val();
        const changefreq = $('#changefreq').val();

        if (url) {
          sitemapData.push({ url, priority, changefreq });
          updateSitemapTable();
          $('#addUrlForm')[0].reset(); // Réinitialiser le formulaire
        }
      });

      // Mettre à jour le tableau des URLs
      function updateSitemapTable() {
        const tableBody = $('#sitemapTable');
        tableBody.empty(); // Vider le tableau avant de le remplir

        sitemapData.forEach((item, index) => {
          tableBody.append(`
            <tr>
              <td>${index + 1}</td>
              <td>${item.url}</td>
              <td>${item.priority}</td>
              <td>${item.changefreq}</td>
              <td>
                <button class="btn btn-sm btn-danger" onclick="removeUrl(${index})"><i class="fas fa-trash"></i> Supprimer</button>
              </td>
            </tr>
          `);
        });
      }

      // Supprimer une URL du tableau
      window.removeUrl = function (index) {
        sitemapData.splice(index, 1); // Retirer l'élément du tableau
        updateSitemapTable();
      };

      // Générer le fichier sitemap.xml
      $('#generateSitemap').on('click', function () {
        if (sitemapData.length === 0) {
          alert('Aucune URL ajoutée au sitemap.');
          return;
        }

        let xmlContent = `<?xml version="1.0" encoding="UTF-8"?>\n<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">\n`;
        sitemapData.forEach((item) => {
          xmlContent += `
  <url>
    <loc>${item.url}</loc>
    <priority>${item.priority}</priority>
    <changefreq>${item.changefreq}</changefreq>
  </url>\n`;
        });
        xmlContent += '</urlset>';

        // Télécharger le fichier sitemap.xml
        const blob = new Blob([xmlContent], { type: 'application/xml' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'sitemap.xml';
        link.click();
      });

      // Effacer toutes les données
      $('#clearSitemap').on('click', function () {
        if (confirm('Voulez-vous vraiment effacer toutes les URLs ?')) {
          sitemapData = [];
          updateSitemapTable();
        }
      });
    });
  </script>
</body>
</html>